# http://www.circitor.fr/Mibs/Html/C/CISCO-ENHANCED-MEMPOOL-MIB.php
---
extends:
  - if-mib.yml
  - system-mib.yml

provider: kentik-firepower

sysobjectid:
  - 1.3.6.1.4.1.9.1.1902           # Cisco VASA (Cisco Firepower Threat Defense, Version 6.7.0.2)
  - 1.3.6.1.4.1.9.1.2404           # Cisco FPR 2110td
  - 1.3.6.1.4.1.9.1.2405           # Cisco FPR 2120td
  - 1.3.6.1.4.1.9.1.2406           # Cisco FPR 2130td
  - 1.3.6.1.4.1.9.1.2407           # Cisco FPR 2140td
  - 1.3.6.1.4.1.9.1.2409           # Cisco FPR 9000SM44
  - 1.3.6.1.4.1.9.12.3.1.3.1788    # Cisco FPR 4120
  - 1.3.6.1.4.1.9.1.2775           # Cisco FPR 4125 M32
  - 1.3.6.1.4.1.9.1.2778           # Cisco FPR 4125 K9
  - 1.3.6.1.4.1.9.1.2316           # Cisco FPR 4150 SM44
  - 1.3.6.1.4.1.9.1.2292           # Cisco FPR 4150 K9

metrics:
  # A table of overall CPU statistics.
  - MIB: CISCO-PROCESS-MIB
    table:
      OID: 1.3.6.1.4.1.9.9.109.1.1.1
      name: cpmCPUTotalTable
    symbols:
      # CPU Utilization - polled at 60s to support anomaly detection
      # The overall CPU busy percentage in the last 1 minute period.
      - OID: 1.3.6.1.4.1.9.9.109.1.1.1.1.7
        name: cpmCPUTotal1minRev
        tag: CPU
        poll_time_sec: 60
  # A table of memory pool monitoring entries.
  # Polled at 60s to support anomaly detection.
  - MIB: CISCO-ENHANCED-MEMPOOL-MIB
    table:
      name: ciscoMemoryPoolTable
      OID: 1.3.6.1.4.1.9.9.221.1.1.1
    symbols:
      # Indicates the number of bytes from the memory pool that are currently in use by applications on the managed device.
      - name: cempMemPoolUsed
        OID: 1.3.6.1.4.1.9.9.221.1.1.1.1.7
        poll_time_sec: 60
        tag: MemoryUsed
      # Indicates the number of bytes from the memory pool that are currently unused on the managed device.
      - name: cempMemPoolFree
        OID: 1.3.6.1.4.1.9.9.221.1.1.1.1.8
        poll_time_sec: 60
        tag: MemoryFree
    metric_tags:
      # A textual name assigned to the memory pool.
      - tag: memory_pool_name
        column:
          OID: 1.3.6.1.4.1.9.9.221.1.1.1.1.3
          name: cempMemPoolName
  # Sessions Total - polled at 60s to support anomaly detection
  # The number of currently active sessions.
  - MIB: CISCO-REMOTE-ACCESS-MONITOR-MIB
    symbols:
      - OID: 1.3.6.1.4.1.9.9.392.1.4.1.2.0
        name: crasNumDeclinedSessions
      - OID: 1.3.6.1.4.1.9.9.392.1.3.1.0
        name: crasNumSessions
        poll_time_sec: 60
      - OID: 1.3.6.1.4.1.9.9.392.1.1.1.0
        name: crasMaxSessionsSupportable
      - OID: 1.3.6.1.4.1.9.9.392.1.3.3.0
        name: crasNumUsers
      - OID: 1.3.6.1.4.1.9.9.392.1.1.2.0
        name: crasMaxUsersSupportable
      - OID: 1.3.6.1.4.1.9.9.392.1.4.1.3.0
        name: crasNumSetupFailInsufResources
